apiVersion: secrets.infisical.com/v1alpha1
kind: InfisicalSecret
metadata:
  name: cloudflare-secret
  namespace: cert-manager
spec:
  hostAPI: https://infisical.kubefrog.fr
  resyncInterval: 10
  authentication:
    kubernetesAuth:
      identityId: 4e954874-bf29-48f2-8c06-44be91d9cc1e
      serviceAccountRef:
        name: infisical-auth
        namespace: default
      secretsScope:
        projectSlug: kubefrog-vps-7k-ft
        envSlug: prod
        secretsPath: "/CLOUDFLARE_KUBEFROG"
        secretName: # OPTIONAL: If you want to fetch a single Infisical secret, you can specify the secret name here. If not specified, all secrets in the specified scope will be fetched.
        recursive: true

  managedKubeSecretReferences:
    - secretName: cloudflare-secret
      secretNamespace: cert-manager
      creationPolicy: "Orphan"
      template:
        includeAllSecrets: no
        data:
          zonedId: "{{ .CLOUDFLARE_KUBEFROG_ZONEID.Value }}"
          token: "{{ .CLOUDFLARE_TOKEN.Value }}"
  
