apiVersion: kubeflow.org/v1alpha1
kind: PodDefault
metadata:
  name: pipelinetoken
  namespace: frederik-coquelet
spec:
  desc: Allow access to Kubeflow Pipelines v2
  selector:
    matchLabels:
      pipelinetoken: "true"
  volumeMounts:
  - mountPath: /var/run/secrets/kubeflow/pipelines/
    name: volume-ml-pipeline-token
    readOnly: true
  volumes:
  - name: volume-ml-pipeline-token
    projected:
      sources:
      - serviceAccountToken:
          path: token
          expirationSeconds: 7200
          audience: pipelines.kubeflow.org
  env:
  - name: KF_PIPELINE_SA_TOKEN_PATH
    value: /var/run/secrets/kubeflow/pipelines/token  # this is dependent on the volume mount path and SAT path

